[{"id":"50279043.d87c1","type":"function","z":"f6dc6ba7.efedb8","name":"Werte extrahieren","func":"var checksum = 0\nvar check = false\nvar i_phase = false\nvar u1_phase = false\nvar u2_phase = false\nvar u3_phase = false\nvar standby = false\nvar abregelung = false\nvar AES = false\n\n//ID\nID = msg.payload[1]\n\n//Spannung Bordbatterie U16\n//u_bord = (msg.payload[3] << 8) + msg.payload[2]\nu_bord = msg.payload.readUInt16LE(2)\nu_bord_mv = u_bord*10\nu_bord_v = u_bord_mv/1000\n\n//Spannung Solar U16\n//u_solar = (msg.payload[5] << 8) + msg.payload[4]\nu_solar = msg.payload.readUInt16LE(4)\nu_solar_mv = u_solar*10\nu_solar_v = u_solar_mv/1000\n\n\n//Strom Solar S16\ni_solar = msg.payload.readInt16LE(6)\ni_solar_ma = i_solar*10\ni_solar_a = i_solar_ma/1000\n\n//Batteriestatus\nif (msg.payload[13] & (1 << 0)){\n        i_phase = true\n}\nif (msg.payload[13] & (1 << 1)){\n        u1_phase = true\n}\nif (msg.payload[13] & (1 << 2)){\n        u2_phase = true\n}\nif (msg.payload[13] & (1 << 3)){\n        u3_phase = true\n}\n\n//Reglerstatus\nif (msg.payload[14] & (1 << 3)){\n        standby = true\n}\nif (msg.payload[14] & (1 << 4)){\n        abregelung = true\n}\nif (msg.payload[14] & (1 << 5)){\n        AES = true\n}\n\n//checksumme berechnen\nfor (var i=1;i<15;i++){\n    checksum = checksum ^ msg.payload[i]\n}\n\n//checksumme prÃ¼fen\nif (checksum == msg.payload[15]){\n    check = true\n}\n\nmsg.payload = {\n    ID: ID,\n    u_bord_v: u_bord_v,\n    u_solar_v: u_solar_v,\n    i_solar_a: i_solar_a,\n    i_phase: i_phase,\n    u1_phase: u1_phase,\n    u2_phase: u2_phase,\n    u3_phase: u3_phase,\n    standby: standby,\n    abregelung: abregelung,\n    AES: AES,\n    checksum_calc: checksum,\n    cecksum_rx: msg.payload[15],\n    check: check\n}\n\n//if (check === true){\nreturn msg;\n//}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":590,"y":460,"wires":[["44e91de4.925164","c22e6f4d.cc43f","92a3221c.2f9a8","902fab81.b56db8","97fc3fd1.6af3d","2a78eaa6.81fcc6","20e0ea49.879246","1378be59.263242","514d1aeb.c8e834","919f03fe.4f293","dc321bf9.2fae78"]]}]